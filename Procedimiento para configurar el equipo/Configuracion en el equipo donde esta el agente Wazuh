# 🛠️ CREAR REGLA PERSONALIZADA EN WAZUH

En esta guía aprenderás a crear reglas personalizadas en **Wazuh** para monitorear eventos específicos, como actividades sospechosas en sistemas Windows detectadas por **Sysmon**.  
Además, veremos cómo asignar estas reglas a **grupos de agentes**, permitiendo una gestión segmentada y eficiente según el tipo de dispositivo (por ejemplo: servidores, estaciones de trabajo).

---

## 🎯 Objetivos

Con este enfoque, podrás:

- 🕵️‍♂️ **Detectar amenazas personalizadas**, como procesos no autorizados o cambios críticos.
- 🚨 **Priorizar alertas** según la criticidad (`level`).
- 🧩 **Filtrar reglas por grupos**, utilizando etiquetas como `windows` o `linux`, optimizando el análisis.

---

## 🔧 Instalación de herramientas necesarias

Primero, en el equipo donde se encuentre instalado el **agente Wazuh**, debes descargar los siguientes archivos:

- [Sysmon de Microsoft](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon)
- [Sysmon-Modular (reglas predefinidas)](https://github.com/olafhartong/sysmon-modular)

---

## 💻 Ejecución del comando

Una vez instalado, ejecutamos el siguiente comando:

![Ejemplo comando](https://user-images.githubusercontent.com/123456789/imagename1.png)

---

## 📊 Resultado esperado

Al finalizar, deberías ver un resultado similar a este:

![Resultado](https://user-images.githubusercontent.com/123456789/imagename2.png)

---

## ✅ Conclusión

Con esto, ya estarían configurados los elementos necesarios en el equipo donde se encuentra el **agente Wazuh**.  
En resumen:

> Se requiere instalar el **agente Wazuh** y **Sysmon**, además de aplicar reglas personalizadas para una detección más precisa y segmentada de eventos.

---

## 📌 Notas adicionales

- Asegúrate de reiniciar el agente tras hacer cambios en la configuración.
- Puedes seguir monitoreando el estado del agente desde el dashboard de Wazuh.
